import{u as q,r as u,W as P,j as e,q as k,b as O,d as C,y as M}from"./app-39d32580.js";import{B as I,S as z}from"./index-a22c4d29.js";import{C as B,a as D,b as T,c as S,d as A,e as E}from"./index-801a1316.js";import{F as $}from"./index-f8683352.js";import{g as H,o as L,d as R,r as F}from"./index.esm-2158556a.js";import{A as V,H as _,T as W,B as G,c as J}from"./AuthLayout-cd96a75d.js";import{a as K}from"./dataSelect-51f2092f.js";import{d as g,e as N,u as w}from"./mask-c14164de.js";import"./moment-fbc5633a.js";const Q=({produtos:l})=>{const{showModalParts:p,setShowModalParts:x,sendOrderParts:v,setSendOrderParts:d}=q(),[h,n]=u.useState([]),[c,f]=u.useState([]),{data:m,setData:i}=P({pecas:"",quantidade:"",valor:""}),a=r=>{const o=r.toLowerCase(),j=l.filter(s=>s.descricao.toLowerCase().includes(o));n(j)};u.useEffect(()=>{m.pecas===""&&n([])},[m]);const t=r=>{f([...c,r]),i(o=>({...o,pecas:""})),n([])},y=r=>{const o=c.splice(c.indexOf(r),1);f(o)};return e.jsx(e.Fragment,{children:p&&e.jsx("div",{className:"fixed top-0 right-0 bottom-0 left-0 flex items-center justify-center bg-gray-800/100 z-40",children:e.jsxs("div",{className:"w-full sm:max-w-md mx-4 p-4 bg-gradient-to-t from-gray-300 via-white to-gray-200 shadow-md overflow-hidden rounded-md border border-white text-gray-600",children:[e.jsxs("div",{className:"border-b border-b-gray-300 mb-4 flex items-center justify-between",children:[e.jsx("div",{className:"",children:"Adicione peças/produtos a ordem "}),e.jsx("div",{className:"cursor-pointer",children:e.jsx(H,{size:20,onClick:()=>x(!1)})})]}),e.jsxs("div",{className:"flex flex-col col-span-2 relative",children:[e.jsx("label",{className:"label-form",htmlFor:"pecas",children:"Peça"}),e.jsx("input",{id:"pecas",type:"text",value:m.pecas,onChange:r=>{i("pecas",r.target.value),a(r.target.value)},className:"input-form"}),h.length>0&&e.jsx("div",{className:"absolute bg-gray-50 border-2 border-white shadow-md w-full rounded-sm top-16 max-h-52 overflow-y-auto",children:e.jsx("ul",{className:"p-1",children:h.map((r,o)=>e.jsx("li",{className:`flex items-center justify-normal ${o<h.length-1?"border-b border-gray-200":""}`,children:e.jsx("div",{className:"text-sm text-gray-600 p-1 cursor-pointer inline-block w-full",onClick:()=>t({pecaid:r.id,descricao:r.descricao,valor:r.valvenda}),children:r.descricao})},o))})})]}),e.jsxs("div",{className:"mt-4 p-2 border border-gray-300 rounded-md",children:[e.jsx("div",{children:e.jsx("h1",{className:"text-sm font-medium uppercase border-b border-b-gray-300",children:"Peças selecionadas"})}),c.map((r,o)=>e.jsxs("div",{className:`py-1 grid grid-cols-4 ${c.length-1==o?"":"border-b border-b-gray-300"}`,children:[e.jsx("div",{children:r.pecaid}),e.jsx("div",{children:r.descricao}),e.jsx("div",{children:r.valor}),e.jsx("div",{children:e.jsx("button",{type:"button",onClick:()=>y(o),className:"bg-red-500 rounded text-white p-1",children:e.jsx(L,{})})})]},o))]}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{onClick:()=>d(c),className:"flex items-center justify-center bg-blue-700 hover:bg-blue-600 py-1.5 px-3 rounded-md shadow text-gray-50 self-end",children:e.jsx("span",{children:"Inserir peças"})})})]})})})},re=({ordens:l,tecnicos:p,produtos:x,ordemProduto:v,currentPage:d})=>{const{showModalParts:h,setShowModalParts:n,sendOrderParts:c,setSendOrderParts:f}=q(),{flash:m,errors:i}=k().props;x.map(s=>({value:s.id,label:s.descricao})),v.map(s=>({value:s.id,label:s.descricao}));const{data:a,setData:t,progress:y,processing:r}=P({id:l.id,equipamento:l.equipamento,modelo:l.modelo,senha:l.senha,defeito:l.defeito,estado:l.estado,acessorios:l.acessorios,previsao:l.previsao,descorcamento:l.descorcamento,valorcamento:l.valorcamento,preorcamento:l.preorcamento,pecas:v.map(s=>s.id),valpecas:l.valpecas?l.valpecas:"0",valservico:l.valservico?l.valservico:"0",custo:l.custo?l.custo:"0",status:l.status,tecnico:l.tecnico,detalhes:l.detalhes,obs:l.obs,page:d});function o(s){s.preventDefault(),M.post(`/ordens/${l.id}`,{_method:"patch",id:a.id,equipamento:a.equipamento,modelo:a.modelo,senha:a.senha,defeito:a.defeito,estado:a.estado,acessorios:a.acessorios,previsao:a.previsao,descorcamento:a.descorcamento,valorcamento:a.valorcamento,preorcamento:a.preorcamento,pecas:a.pecas,valpecas:N(a.valpecas.toString()),valservico:N(a.valservico.toString()),custo:N(a.custo.toString()),status:a.status,tecnico:a.tecnico,detalhes:a.detalhes,obs:a.obs,page:d})}const j=(s,b)=>parseInt(w(s))+parseInt(w(b));return u.useEffect(()=>{const s=j(a.valpecas.toString(),a.valservico.toString());t(b=>({...b,custo:s}))},[a]),e.jsxs(e.Fragment,{children:[e.jsx(Q,{produtos:x}),e.jsxs(V,{children:[e.jsx(O,{title:"Ordens"}),e.jsxs(B,{children:[e.jsxs(_,{children:[e.jsxs(W,{children:[e.jsx(R,{size:30}),e.jsx("span",{className:"ml-2",children:"Ordens"})]}),e.jsx(G,{links:[{url:"/ordens",label:"Ordens"},{url:null,label:"Adicionar ordem"}]})]}),e.jsxs(D,{children:[e.jsx($,{message:m}),e.jsxs(T,{children:[e.jsx(S,{children:e.jsx(I,{url:`/ordens?page=${d}`,label:"Voltar"})}),e.jsx(S,{children:e.jsx(e.Fragment,{})})]}),e.jsxs("form",{onSubmit:o,autoComplete:"off",children:[e.jsx(A,{className:" border-y border-gray-100",children:e.jsxs("div",{className:"px-3 my-4",children:[e.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"ordem",children:"Ordem"}),e.jsx("input",{id:"ordem",type:"text",value:a.id,className:"input-form",disabled:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-2",children:[e.jsx("label",{className:"label-form",htmlFor:"cliente_id",children:"Nome do cliente"}),e.jsx("input",{id:"equipamento",type:"text",value:l.cliente.nome,className:"input-form",disabled:!0})]}),e.jsxs("div",{className:"flex flex-col col-span-2",children:[e.jsx("label",{className:"label-form",htmlFor:"equipamento",children:"Tipo de equipamento"}),e.jsx("input",{id:"equipamento",type:"text",value:a.equipamento,onChange:s=>t("equipamento",s.target.value),className:"input-form"}),i.equipamento&&e.jsx("div",{className:"text-sm text-red-500",children:i.equipamento})]})]}),e.jsxs("div",{className:"grid grid-cols-4 gap-4 mt-6",children:[e.jsxs("div",{className:"flex flex-col col-span-2",children:[e.jsx("label",{className:"label-form",htmlFor:"modelo",children:"Modelo do equipamento"}),e.jsx("input",{id:"modelo",type:"text",value:a.modelo,onChange:s=>t("modelo",s.target.value),className:"input-form"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"senha",children:"Senha do equipamento"}),e.jsx("input",{id:"senha",type:"text",value:a.senha,onChange:s=>t("senha",s.target.value),className:"input-form"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"previsao",children:"Previsão de entrega"}),e.jsx("input",{id:"previsao",type:"date",value:a.previsao,onChange:s=>t("previsao",s.target.value),className:"input-form"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"defeito",children:"Defeito relatado/Serviço solicitado"}),e.jsx("textarea",{id:"defeito",value:a.defeito,onChange:s=>t("defeito",s.target.value),className:"input-form"}),i.defeito&&e.jsx("div",{className:"text-sm text-red-500",children:i.defeito})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"estado",children:"Estado do equipamento"}),e.jsx("textarea",{id:"estado",value:a.estado,onChange:s=>t("estado",s.target.value),className:"input-form"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"acessorios",children:"Acessórios"}),e.jsx("textarea",{id:"acessorios",value:a.acessorios,onChange:s=>t("acessorios",s.target.value),className:"input-form"})]})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-4 mt-6",children:[e.jsxs("div",{className:"flex flex-col col-span-3",children:[e.jsx("label",{className:"label-form",htmlFor:"pecas",children:"Peças utilizadas"}),e.jsxs("div",{className:"flex items-center justify-start w-full",children:[e.jsx("input",{id:"pecas",value:a.pecas,onChange:s=>t("pecas",s.target.value),className:"input-form !rounded-r-none w-full"}),e.jsx("button",{title:"Inserir peças",type:"button",className:"bg-blue-700 hover:bg-blue-600 py-2.5 px-3 rounded-r-md shadow text-gray-50 self-end",onClick:()=>n(!0),children:e.jsx(J,{size:22})})]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"valpecas",children:"Valor das peças"}),e.jsx("input",{id:"valpecas",type:"text",value:g(a.valpecas.toString()),onChange:s=>t("valpecas",s.target.value),className:"input-form"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"valservico",children:"Valor do serviço"}),e.jsx("input",{id:"valservico",type:"text",value:g(a.valservico.toString()),onChange:s=>t("valservico",s.target.value),className:"input-form"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"custo",children:"Custo total"}),e.jsx("input",{id:"custo",type:"text",value:g(a.custo.toString()),onChange:s=>t("custo",s.target.value),className:"input-form",readOnly:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"tecnico",children:"Técnico"}),e.jsxs("select",{id:"tecnico",value:a.tecnico,onChange:s=>t("tecnico",s.target.value),className:"input-form",children:[e.jsx("option",{value:"",children:"Slecione o técnico"}),p.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]}),i.tecnico&&e.jsx("div",{className:"text-sm text-red-500",children:i.tecnico})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"status",children:"Status do serviço"}),e.jsxs("select",{id:"status",value:a.status,onChange:s=>t("status",s.target.value),className:"input-form",children:[e.jsx("option",{value:"",children:"Selecione o status"}),K.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"preorcamento",children:"Pré-orçamento"}),e.jsx("textarea",{id:"preorcamento",value:a.preorcamento,onChange:s=>t("preorcamento",s.target.value),className:"input-form"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"descorcamento",children:"Descrição do orçamento"}),e.jsx("textarea",{id:"descorcamento",value:a.descorcamento,onChange:s=>t("descorcamento",s.target.value),className:"input-form"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"detalhes",children:"Detalhes do serviço"}),e.jsx("textarea",{id:"detalhes",value:a.detalhes,onChange:s=>t("detalhes",s.target.value),className:"input-form"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"label-form",htmlFor:"obs",children:"Observações"}),e.jsx("textarea",{id:"obs",value:a.obs,onChange:s=>t("obs",s.target.value),className:"input-form"})]})]})]})}),e.jsx(E,{children:e.jsxs("div",{className:"flex items-center justify-end gap-4",children:[l.status===8&&e.jsxs(e.Fragment,{children:[e.jsxs(C,{disabled:l.status!="8",as:"button",href:`/docs/printer?or=${l.id}&tp=2`,className:"flex items-center justify-center bg-teal-700 hover:bg-teal-700/90 py-1.5 px-3 rounded-md shadow text-gray-50 self-end transition-colors duration-300",children:[e.jsx(F,{size:18}),e.jsx("span",{className:"ml-2",children:"Recibo de entrega"})]}),e.jsxs(C,{disabled:l.status!="8",as:"button",href:`/docs/printer?or=${l.id}&tp=4`,className:"flex items-center justify-center bg-teal-700 hover:bg-teal-700/90 py-1.5 px-3 rounded-md shadow text-gray-50 self-end transition-colors duration-300",children:[e.jsx(F,{size:18}),e.jsx("span",{className:"ml-2",children:"Checklist de entrega"})]})]}),e.jsx(z,{})]})})]})]})]})]})]})};export{re as default};
